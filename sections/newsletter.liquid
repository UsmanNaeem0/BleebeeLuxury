{% comment %}
  Newsletter section
{% endcomment %}

{% schema %}
{
  "name": "Newsletter",
  "settings": [
    {
      "type": "text",
      "id": "section_title",
      "label": "Section Title",
      "default": "Join the Glow Club"
    },
    {
      "type": "textarea",
      "id": "section_subtitle",
      "label": "Section Subtitle",
      "default": "Subscribe for skincare tips, exclusive offers, and be the first to know about new products"
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button Text",
      "default": "Subscribe"
    }
  ]
}
{% endschema %}

<section class="newsletter-section" data-testid="section-newsletter">
  <div class="newsletter-section__background"></div>
  <div class="newsletter-section__decoration"></div>

  <div class="newsletter-section__container">
    <div class="newsletter-section__icon">
      <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <rect width="20" height="16" x="2" y="4" rx="2"></rect>
        <path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"></path>
      </svg>
    </div>

    <h2 class="newsletter-section__title" data-testid="text-newsletter-title">
      {{ section.settings.section_title | default: "Join the Glow Club" }}
    </h2>
    <p class="newsletter-section__subtitle" data-testid="text-newsletter-subtitle">
      {{ section.settings.section_subtitle | default: "Subscribe for skincare tips, exclusive offers, and be the first to know about new products" }}
    </p>

    {% form 'customer', class: 'newsletter-form' %}
      <div class="newsletter-form__group">
        <input 
          type="email" 
          name="contact[email]" 
          placeholder="Enter your email" 
          class="newsletter-form__input"
          data-testid="input-newsletter-email"
          required
        >
        <button type="submit" class="button button--primary button--large newsletter-form__button" data-testid="button-newsletter-submit">
          {{ section.settings.button_text | default: "Subscribe" }}
        </button>
      </div>
    {% endform %}

    <p class="newsletter-section__privacy">
      We respect your privacy. Unsubscribe at any time.
    </p>
  </div>
</section>

<style>
  .newsletter-section {
    position: relative;
    padding: 4rem 1rem;
    background: linear-gradient(to bottom right, hsl(var(--primary) / 0.05), hsl(var(--background)), hsl(42 100% 69% / 0.05));
    overflow: hidden;
  }

  @media (min-width: 768px) {
    .newsletter-section {
      padding: 6rem 1rem;
    }
  }

  @media (min-width: 1024px) {
    .newsletter-section {
      padding: 8rem 1rem;
    }
  }

  .newsletter-section__background {
    position: absolute;
    inset: 0;
    opacity: 0.05;
    background-image: radial-gradient(circle at 20% 50%, hsl(var(--primary)) 2px, transparent 2px);
    background-size: 50px 50px;
  }

  .newsletter-section__decoration {
    position: absolute;
    top: 25%;
    right: 25%;
    width: 2.5rem;
    height: 2.5rem;
    animation: float-slow 8s ease-in-out infinite;
    opacity: 0.3;
  }

  .newsletter-section__decoration::before {
    content: '';
    display: block;
    width: 100%;
    height: 100%;
    background: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Ccircle cx='50' cy='30' r='8' fill='currentColor' opacity='0.6'/%3E%3Cpath d='M50 40 L55 55 L50 50 L45 55 Z' fill='currentColor' opacity='0.4'/%3E%3Cpath d='M50 55 L52 70 L50 65 L48 70 Z' fill='currentColor' opacity='0.3'/%3E%3C/svg%3E") no-repeat center;
    background-size: contain;
    color: hsl(var(--primary));
  }

  .newsletter-section__container {
    max-width: 48rem;
    margin: 0 auto;
    text-align: center;
    position: relative;
    z-index: 10;
  }

  .newsletter-section__icon {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 5rem;
    height: 5rem;
    border-radius: 50%;
    background: linear-gradient(to bottom right, hsl(var(--primary) / 0.2), hsl(42 100% 69% / 0.2));
    margin-bottom: 1.5rem;
    color: hsl(var(--primary));
  }

  @media (min-width: 768px) {
    .newsletter-section__icon {
      width: 5rem;
      height: 5rem;
    }
  }

  .newsletter-section__title {
    font-family: var(--font-serif);
    font-size: clamp(1.875rem, 4vw, 3rem);
    font-weight: bold;
    color: hsl(var(--foreground));
    margin-bottom: 1rem;
  }

  .newsletter-section__subtitle {
    font-size: 1rem;
    color: hsl(var(--muted-foreground));
    margin-bottom: 2rem;
    max-width: 36rem;
    margin-left: auto;
    margin-right: auto;
  }

  @media (min-width: 768px) {
    .newsletter-section__subtitle {
      font-size: 1.125rem;
    }
  }

  .newsletter-form {
    max-width: 28rem;
    margin: 0 auto 1rem;
  }

  .newsletter-form__group {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  @media (min-width: 640px) {
    .newsletter-form__group {
      flex-direction: row;
    }
  }

  .newsletter-form__input {
    flex: 1;
    height: 3rem;
    padding: 0 1.5rem;
    font-size: 1rem;
    border: 2px solid hsl(var(--primary) / 0.3);
    border-radius: 0.5rem;
    background: hsl(var(--background));
    color: hsl(var(--foreground));
    transition: border-color 0.3s;
  }

  @media (min-width: 768px) {
    .newsletter-form__input {
      height: 3.5rem;
    }
  }

  .newsletter-form__input:focus {
    outline: none;
    border-color: hsl(var(--primary));
  }

  .newsletter-form__button {
    white-space: nowrap;
  }

  @media (min-width: 640px) {
    .newsletter-form__button {
      width: auto;
    }
  }

  .newsletter-section__privacy {
    font-size: 0.75rem;
    color: hsl(var(--muted-foreground));
    margin-top: 1rem;
  }
</style>

